//! Implementations for Monolith over Goldilocks field of widths 8 and 12.

use crate::field::goldilocks_field::GoldilocksField;
use crate::hash::monolith::{Monolith,SPONGE_WIDTH, N_ROUNDS};

#[rustfmt::skip]
impl Monolith for GoldilocksField {

    const MAT_12: [[u64; SPONGE_WIDTH]; SPONGE_WIDTH] = [
        [7, 23, 8, 26, 13, 10, 9, 7, 6, 22, 21, 8],
        [8, 7, 23, 8, 26, 13, 10, 9, 7, 6, 22, 21],
        [21, 8, 7, 23, 8, 26, 13, 10, 9, 7, 6, 22],
        [22, 21, 8, 7, 23, 8, 26, 13, 10, 9, 7, 6],
        [6, 22, 21, 8, 7, 23, 8, 26, 13, 10, 9, 7],
        [7, 6, 22, 21, 8, 7, 23, 8, 26, 13, 10, 9],
        [9, 7, 6, 22, 21, 8, 7, 23, 8, 26, 13, 10],
        [10, 9, 7, 6, 22, 21, 8, 7, 23, 8, 26, 13],
        [13, 10, 9, 7, 6, 22, 21, 8, 7, 23, 8, 26],
        [26, 13, 10, 9, 7, 6, 22, 21, 8, 7, 23, 8],
        [8, 26, 13, 10, 9, 7, 6, 22, 21, 8, 7, 23],
        [23, 8, 26, 13, 10, 9, 7, 6, 22, 21, 8, 7],
    ];

    const ROUND_CONSTANTS: [[u64; SPONGE_WIDTH]; N_ROUNDS + 1] = [
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
        [13596126580325903823, 5676126986831820406, 11349149288412960427, 3368797843020733411, 16240671731749717664, 9273190757374900239, 14446552112110239438, 4033077683985131644, 4291229347329361293, 13231607645683636062, 1383651072186713277, 8898815177417587567],
        [2383619671172821638, 6065528368924797662, 16737578966352303081, 2661700069680749654, 7414030722730336790, 18124970299993404776, 9169923000283400738, 15832813151034110977, 16245117847613094506, 11056181639108379773, 10546400734398052938, 8443860941261719174],
        [15799082741422909885, 13421235861052008152, 15448208253823605561, 2540286744040770964, 2895626806801935918, 8644593510196221619, 17722491003064835823, 5166255496419771636, 1015740739405252346, 4400043467547597488, 5176473243271652644, 4517904634837939508],
        [18341030605319882173, 13366339881666916534, 6291492342503367536, 10004214885638819819, 4748655089269860551, 1520762444865670308, 8393589389936386108, 11025183333304586284, 5993305003203422738, 458912836931247573, 5947003897778655410, 17184667486285295106],
        [15710528677110011358, 8929476121507374707, 2351989866172789037, 11264145846854799752, 14924075362538455764, 10107004551857451916, 18325221206052792232, 16751515052585522105, 15305034267720085905, 15639149412312342017, 14624541102106656564, 3542311898554959098],
        [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0],
    ];
}

#[cfg(test)]
mod tests {
    use crate::field::goldilocks_field::GoldilocksField as F;
    use crate::hash::monolith::test_helpers::check_test_vectors;

    #[test]
    fn test_vectors() {
        // Test inputs are:
        // 1. 0..WIDTH-1

        #[rustfmt::skip]
        let test_vectors12: Vec<([u64; 12], [u64; 12])> = vec![
            ([0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, ],
                [5867581605548782913, 588867029099903233, 6043817495575026667, 805786589926590032, 9919982299747097782, 6718641691835914685, 7951881005429661950, 15453177927755089358, 974633365445157727, 9654662171963364206, 6281307445101925412, 13745376999934453119]),
        ];

        check_test_vectors::<F>(test_vectors12);
    }
}
